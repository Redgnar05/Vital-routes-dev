{% extends "base.html" %}
{% block content %}

<section class="dashboard-header">
  <h2>Hola, {{ username }} ðŸ‘‹</h2>
  <p><a href="{{ url_for('update_profile') }}" class="btn-main">Actualizar datos personales</a></p>
  <p>Consulta una ciudad para evaluar condiciones ambientales</p>
</section>

<section class="card">
  <form method="POST" action="{{ url_for('dashboard') }}" class="form">
    <label for="ciudad">Ciudad:</label>
    <input type="text" id="ciudad" name="ciudad" placeholder="Ejemplo: Ciudad de MÃ©xico">

    <button type="submit" class="btn-main">Analizar</button>
  </form>

  {% if error %}
    <div class="alert alert-error">{{ error }}</div>
  {% endif %}
</section>

{% if resultado %}
<section class="card">
  <h2>Resultados para {{ resultado.ciudad }}</h2>

  <div class="grid">
    <div class="box">
      <h3>Clima</h3>
      <p><strong>CondiciÃ³n:</strong> {{ resultado.clima.descripcion }}</p>
      <p><strong>Temperatura:</strong> {{ resultado.clima.temp }} Â°C</p>
      <p><strong>Humedad:</strong> {{ resultado.clima.humedad }} %</p>
    </div>

    <div class="box">
      <h3>Calidad del aire (simulada)</h3>
      <p><strong>PM2.5:</strong> {{ resultado.aire.pm25 }} Âµg/mÂ³</p>
      <p><strong>PM10:</strong> {{ resultado.aire.pm10 }} Âµg/mÂ³</p>
      <p><strong>AQI:</strong> {{ resultado.aire.aqi }} ({{ resultado.aire.categoria }})</p>
    </div>

    <div class="box">
      <h3>Ruido (simulado)</h3>
      <p><strong>Nivel:</strong> {{ resultado.ruido.ruido_db }} dB</p>
      <p><strong>Fuente probable:</strong> {{ resultado.ruido.fuente_probable }}</p>
    </div>
  </div>

  <div class="riesgo riesgo-{{ resultado.riesgo.color }}">
    <h3>Riesgo global para la salud: {{ resultado.riesgo.nivel }}</h3>
    <p>PuntuaciÃ³n interna: {{ resultado.riesgo.score }}</p>
  </div>

  <section class="recomendaciones">
    <h3>Recomendaciones</h3>
    <ul>
      {% for rec in resultado.recomendaciones %}
        <li>{{ rec }}</li>
      {% endfor %}
    </ul>
    <p class="sugerencia"><strong>Horario sugerido:</strong> {{ resultado.sugerencia_horario }}</p>
  </section>
</section>
{% endif %}

{% endblock %}
